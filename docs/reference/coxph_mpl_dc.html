<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fit Cox Proportional Hazard Regression Model under dependent right censoring via MPL and Archimedean Copulas — coxph_mpl_dc • survivalMPLdc</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Fit Cox Proportional Hazard Regression Model under dependent right censoring via MPL and Archimedean Copulas — coxph_mpl_dc" />
<meta property="og:description" content="Simultaneously estimate the regression coefficients and the baseline hazard function of proportional
hazard Cox models under dependent right censoring using maximum penalised likelihood (MPL) and Archimedean Copulas" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">survivalMPLdc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/README.html">survivalMPLdc</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fit Cox Proportional Hazard Regression Model under dependent right censoring via MPL and Archimedean Copulas</h1>
    
    <div class="hidden name"><code>coxph_mpl_dc.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Simultaneously estimate the regression coefficients and the baseline hazard function of proportional
hazard Cox models under dependent right censoring using maximum penalised likelihood (MPL) and Archimedean Copulas</p>
    </div>

    <pre class="usage"><span class='fu'>coxph_mpl_dc</span>(<span class='no'>surv</span>, <span class='no'>cova</span>, <span class='no'>control</span>,<span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>surv</th>
      <td><p>the outcome of survival data, with the first column X (observed time), second column
del (event indicator) and third column eta (dependent right censoring indicator).</p></td>
    </tr>
    <tr>
      <th>cova</th>
      <td><p>the covariate matrix, with dimension of n rows and p columns, where 'n' is the sample size and 'p' is the number of covariates
Default is <code>cova=matrix(0,n,1)</code>, which the covariates are not considered.</p></td>
    </tr>
    <tr>
      <th>control</th>
      <td><p>object of class <code>coxph_mpl_dc.control</code> specifying control options like basis choice,
refer to <code>coxph_mpl_dc.control</code> to see the defaults.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>other arguments. In <code>coxph_mpl_dc</code>, these elements, will be passed to <code><a href='coxph_mpl_dc.control.html'>coxph_mpl_dc.control</a></code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    

<dt>mpl_theta</dt><dd><p>MPL estimates of the regression coefficient for the basis functions of the baseline hazard of T, i.e. theta</p></dd>
<dt>mpl_gamma</dt><dd><p>MPL estimates of the regression coefficient for the basis functions of the baseline hazard of C, i.e. gamma</p></dd>
<dt>mpl_h0t</dt><dd><p>MPL estimates of the baseline hazard for T, i.e. h_0T(x_i)</p></dd>
<dt>mpl_h0c</dt><dd><p>MPL estimates of the baseline hazard for C, i.e. h_0C(x_i)</p></dd>
<dt>mpl_H0t</dt><dd><p>MPL estimates of the baseline cumulative hazard for T, i.e. H_0T(x_i)</p></dd>
<dt>mpl_H0c</dt><dd><p>MPL estimates of the baseline cumulative hazard for C, i.e. H_0c(x_i)</p></dd>
<dt>mpl_S0t</dt><dd><p>MPL estimates of the baseline survival for T, i.e. S_0T(x_i)</p></dd>
<dt>mpl_S0c</dt><dd><p>MPL estimates of the baseline survival for C, i.e. S_0C(x_i)</p></dd>
<dt>mpl_beta</dt><dd><p>MPL estimates of beta</p></dd>
<dt>mpl_phi</dt><dd><p>MPL estimates of phi</p></dd>
<dt>penloglik</dt><dd><p>the penalized log-likelihood function given the MPL estimates</p></dd>
<dt>mpl_Ubeta</dt><dd><p>the first derivative of penalized log-likelihood function with respect to beta given the MPL estimates</p></dd>
<dt>mpl_Uphi</dt><dd><p>the first derivative of penalized log-likelihood unction with respect to phi given the MPL estimates</p></dd>
<dt>mpl_Utheta</dt><dd><p>the first derivative of penalized log-likelihood function with respect to theta given the MPL estimates</p></dd>
<dt>mpl_Ugamma</dt><dd><p>the first derivative of penalized log-likelihood function with respect to gamma given the MPL estimates</p></dd>
<dt>iteration</dt><dd><p>a vector of length 3 indicating the number of iterations used to estimate the smoothing parameter
(first value, equal to 1 when the user specified a chosen value), the beta, phi, theta and gamma parameters during the entire process (second value),
and beta, phi, theta and gamma parameters during the last smoothing parameter iteration (third value)</p></dd>
<dt>mpl_cvl</dt><dd><p>the cross validation value given the MPL estimates</p></dd>
<dt>mpl_aic</dt><dd><p>the AIC value given the MPL estimates</p></dd>
<dt>mpl_beta_sd</dt><dd><p>the asymptotic standard deviation of the MPL estimated beta</p></dd>
<dt>mpl_phi_sd</dt><dd><p>the asymptotic standard deviation of the MPL estimated phi</p></dd>
<dt>mpl_h0t_sd</dt><dd><p>the asymptotic standard deviation of the MPL estimates for the baseline hazard coefficient of T, i.e. theta</p></dd>
<dt>mpl_h0c_sd</dt><dd><p>the asymptotic standard deviation of the MPL estimates for the baseline hazard coefficient of C, i.e. gamma</p></dd>

<dt>mpl_ht0_sd</dt><dd><p>the asymptotic standard deviation of the MPL estimates for the baseline hazard of T</p></dd>
<dt>mpl_hc0_sd</dt><dd><p>the asymptotic standard deviation of the MPL estimates for the baseline hazard of C</p></dd>
<dt>mpl_Ht0_sd</dt><dd><p>the asymptotic standard deviation of the MPL estimates for the cumulative baseline hazard of T</p></dd>
<dt>mpl_Hc0_sd</dt><dd><p>the asymptotic standard deviation of the MPL estimates for the cumulative baseline hazard of C</p></dd>
<dt>mpl_St0_sd</dt><dd><p>the asymptotic standard deviation of the MPL estimates for the baseline survival of T</p></dd>
<dt>mpl_Sc0_sd</dt><dd><p>the asymptotic standard deviation of the MPL estimates for the baseline survival of C</p></dd>

<dt>mpl_est_cov</dt><dd><p>the asymptotic covariance matrix of the MPL estimates</p></dd>
<dt>mpl_beta_phi_zp</dt><dd><p>the MPL estimates for regression coefficient with their corresponding standard deviations, z scores and p-values</p></dd>
<dt>binwv</dt><dd><p>the width of each discretized bin of the observed times when piecewise constant approximation applied to the baseline hazards</p></dd>
<dt>ID</dt><dd><p>the bin ID for each individual of the sample when piecewise constant approximation applied to the baseline hazards</p></dd>
<dt>binedg</dt><dd><p>the edge for each discretized bin among the observed time vector X, which are the internal knots and boundaries</p></dd>
<dt>psix</dt><dd><p>basis function matrix psi(x_i) with dimension of n by m for baseline hazard, where m=number of internal knots+ordSp</p></dd>
<dt>Psix</dt><dd><p>basis function matrix Psi(x_i) with dimension of n by m for baseline cumulative hazard</p></dd>
Inputs defined in coxph_mpl_dc.control

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>coxph_mpl_dc allows to simultaneously estimate the regression coefficients and baseline hazard function of Cox proportional hazard models,
with dependent and independent right censored data, by maximizing a penalized likelihood,
in which a penalty function is used to smooth the baseline hazard estimates.
Note that the dependence between event and censoring times is modelled by an Archimedean copula.</p>
<p>Optimization is achieved using an iterative algorithm, which combines Newton’s method and the multiplicative iterative algorithm proposed by Ma (2010),
and respects the non-negativity constraints on the baseline hazard estimate (refer to Ma et al (2014) and Xu et al (2018)).</p>
<p>The centered covariate matrix \(Z\) is used in the optimization process to get a better shaped (penalized) log-likelihood.
Baseline hazard parameter estimates and covariance matrix are then respectively corrected using a correction factor and the delta method.</p>
<p>The estimates of zero are possible for baseline hazard parameters (e.g., when number of knots is relatively large to sample size) and
will correspond to active constraints as defined by Moore and Sadler (2008). Inference, as described by Ma et al (2014) or Xu et al (2018),
is then corrected accordingly (refer to Moore and Sadler (2008)) by adequately cutting the corresponding covariance matrix.</p>
<p>There are currently three ways to perform inference on model parameters: Let \(H\) denote the negative of Hessian matrix of the non-penalized likelihood,
\(Q\) denote the product of the first order derivative of the penalized likelihood by its transpose,
and \(M_2\) denote the negative of the second order derivative of the penalized likelihood.
Then the three estimated covariance matrices for the MPL estimates are \(M_{2}^{-1}\), \(M_{2}^{-1}HM_{2}^{-1}\) and \(M_{2}^{-1}QM_{2}^{-1}\).</p>
<p>Simulation studies the coverage levels of confidence intervals for the regression parameters seem to indicate
\(M_{2}^{-1}HM_{2}^{-1}\) performs better when using the piecewise constant basis,
and that \(M_{2}^{-1}QM_{2}^{-1}\)  performs better when using other bases.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Ma, J. (2010). <em>"Positively constrained multiplicative iterative algorithm for maximum penalised likelihood tomographic reconstruction"</em>.
IEEE Transactions On Signal Processing 57, 181-192.</p>
<p>Ma, J. and Heritier, S. and Lo, S. (2014). <em>"On the Maximum Penalised Likelihood Approach forProportional Hazard Models with Right Censored Survival Data"</em>.
Computational Statistics and Data Analysis 74, 142-156.</p>
<p>Xu J, Ma J, Connors MH, Brodaty H. (2018). <em>"Proportional hazard model estimation under dependent censoring using copulas and penalized likelihood"</em>.
Statistics in Medicine 37, 2238–2251.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='plot.coxph_mpl_dc.html'>plot.coxph_mpl_dc</a></code>, <code><a href='coxph_mpl_dc.control.html'>coxph_mpl_dc.control</a></code>, <code><a href='coef.coxph_mpl_dc.html'>coef.coxph_mpl_dc</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># \donttest{</span>
 <span class='co'>##-- Copula types</span>
 <span class='no'>copula1</span> <span class='kw'>&lt;-</span> <span class='st'>'clayton'</span>
 <span class='no'>copula2</span> <span class='kw'>&lt;-</span> <span class='st'>'gumbel'</span>
 <span class='no'>copula3</span> <span class='kw'>&lt;-</span> <span class='st'>'frank'</span>
 <span class='no'>copula4</span> <span class='kw'>&lt;-</span> <span class='st'>'independent'</span>

 <span class='co'>##-- Marginal distribution for T, C, and A</span>
 <span class='no'>a</span> <span class='kw'>&lt;-</span> <span class='fl'>2</span>
 <span class='no'>lambda</span> <span class='kw'>&lt;-</span> <span class='fl'>2</span>
 <span class='no'>cons7</span> <span class='kw'>&lt;-</span> <span class='fl'>0.2</span>
 <span class='no'>cons9</span> <span class='kw'>&lt;-</span> <span class='fl'>10</span>
 <span class='no'>tau</span> <span class='kw'>&lt;-</span> <span class='fl'>0.8</span>
 <span class='no'>betas</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(-<span class='fl'>0.5</span>, <span class='fl'>0.1</span>)
 <span class='no'>phis</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.3</span>, <span class='fl'>0.2</span>)
 <span class='no'>distr.ev</span> <span class='kw'>&lt;-</span> <span class='st'>'weibull'</span>
 <span class='no'>distr.ce</span> <span class='kw'>&lt;-</span> <span class='st'>'exponential'</span>

 <span class='co'>##-- Sample size</span>
 <span class='no'>n</span> <span class='kw'>&lt;-</span> <span class='fl'>200</span>

 <span class='co'>##-- One sample Monte Carlo dataset</span>
 <span class='no'>cova</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Binomial.html'>rbinom</a></span>(<span class='no'>n</span>, <span class='fl'>1</span>, <span class='fl'>0.5</span>), <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='no'>n</span>, <span class='kw'>min</span><span class='kw'>=</span>-<span class='fl'>10</span>, <span class='kw'>max</span><span class='kw'>=</span><span class='fl'>10</span>))
 <span class='no'>surv</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='surv_data_dc.html'>surv_data_dc</a></span>(<span class='no'>n</span>, <span class='no'>a</span>, <span class='no'>cova</span>, <span class='no'>lambda</span>, <span class='no'>betas</span>, <span class='no'>phis</span>, <span class='no'>cons7</span>, <span class='no'>cons9</span>, <span class='no'>tau</span>, <span class='no'>copula3</span>,
                     <span class='no'>distr.ev</span>, <span class='no'>distr.ce</span>)
 <span class='no'>n</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span>(<span class='no'>cova</span>)
 <span class='no'>p</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span>(<span class='no'>cova</span>)
 <span class='co'>##-- event and dependent censoring proportions</span>
 <span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>colSums</a></span>(<span class='no'>surv</span>)[<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2</span>,<span class='fl'>3</span>)]/<span class='no'>n</span></div><div class='output co'>#&gt;   del   eta 
#&gt; 0.415 0.415 </div><div class='input'> <span class='no'>X</span> <span class='kw'>&lt;-</span> <span class='no'>surv</span>[,<span class='fl'>1</span>] <span class='co'># Observed time</span>
 <span class='no'>del</span><span class='kw'>&lt;-</span><span class='no'>surv</span>[,<span class='fl'>2</span>] <span class='co'># failure status</span>
 <span class='no'>eta</span><span class='kw'>&lt;-</span><span class='no'>surv</span>[,<span class='fl'>3</span>] <span class='co'># dependent censoring status</span>

 <span class='co'>##-- Selecting bin sample or number of knots using AIC vs binCounts plot</span>
 <span class='no'>binCounts</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>10</span>, <span class='fl'>100</span>, <span class='fl'>10</span>)
 <span class='no'>bn</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>binCounts</span>)
 <span class='no'>aics</span><span class='kw'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>0</span>, <span class='no'>bn</span>)
 <span class='kw'>for</span> (<span class='no'>j</span> <span class='kw'>in</span> <span class='fl'>1</span>:<span class='no'>bn</span>)
 { <span class='no'>control</span><span class='kw'>=</span><span class='fu'><a href='coxph_mpl_dc.control.html'>coxph_mpl_dc.control</a></span>(<span class='kw'>ordSp</span> <span class='kw'>=</span> <span class='fl'>4</span>,
                             <span class='kw'>binCount</span> <span class='kw'>=</span> <span class='no'>binCounts</span>[<span class='no'>j</span>], <span class='kw'>tie</span> <span class='kw'>=</span> <span class='st'>'No'</span>,
                             <span class='kw'>tau</span> <span class='kw'>=</span> <span class='fl'>0.8</span>, <span class='kw'>copula</span> <span class='kw'>=</span> <span class='no'>copula3</span>,
                             <span class='kw'>pent</span> <span class='kw'>=</span> <span class='st'>'penalty_mspl'</span>, <span class='kw'>smpart</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>penc</span> <span class='kw'>=</span> <span class='st'>'penalty_mspl'</span>, <span class='kw'>smparc</span> <span class='kw'>=</span> <span class='fl'>0</span>,
                             <span class='kw'>maxit2</span> <span class='kw'>=</span> <span class='fl'>100</span>, <span class='kw'>maxit</span> <span class='kw'>=</span> <span class='fl'>5000</span>,
                             <span class='kw'>mid</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>asy</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>ac</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>cv</span> <span class='kw'>=</span> <span class='fl'>0</span>,
                             <span class='kw'>ac.theta</span> <span class='kw'>=</span> <span class='fl'>1e-5</span>, <span class='kw'>ac.gamma</span> <span class='kw'>=</span> <span class='fl'>1e-5</span>, <span class='kw'>ac.Utheta</span> <span class='kw'>=</span> -<span class='fl'>1e-2</span>, <span class='kw'>ac.Ugamma</span> <span class='kw'>=</span> -<span class='fl'>1e-2</span>,
                             <span class='kw'>min.theta</span> <span class='kw'>=</span> <span class='fl'>1e-7</span>, <span class='kw'>min.gamma</span> <span class='kw'>=</span> <span class='fl'>1e-7</span>, <span class='kw'>min.ht</span> <span class='kw'>=</span> <span class='fl'>1e-7</span>, <span class='kw'>min.hc</span> <span class='kw'>=</span> <span class='fl'>1e-7</span>,
                             <span class='kw'>min.St</span> <span class='kw'>=</span> <span class='fl'>1e-7</span>, <span class='kw'>min.Sc</span> <span class='kw'>=</span> <span class='fl'>1e-7</span>, <span class='kw'>min.C</span> <span class='kw'>=</span> <span class='fl'>1e-7</span>, <span class='kw'>min.dC</span> <span class='kw'>=</span> <span class='fl'>1e-7</span>,
                             <span class='kw'>eps</span> <span class='kw'>=</span> <span class='fl'>1e-5</span>, <span class='kw'>tol.thga</span> <span class='kw'>=</span> <span class='fl'>1e-5</span>, <span class='kw'>tol.bph</span> <span class='kw'>=</span> <span class='fl'>1e-5</span>, <span class='kw'>tol.smpar</span> <span class='kw'>=</span> <span class='fl'>1e-2</span>,
                             <span class='kw'>cat.smpar</span> <span class='kw'>=</span> <span class='st'>'No'</span> )
<span class='no'>aics</span>[<span class='no'>j</span>]<span class='kw'>&lt;-</span><span class='fu'>coxph_mpl_dc</span>(<span class='no'>surv</span>, <span class='no'>cova</span>, <span class='no'>control</span>)$<span class='no'>mpl_aic</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span>(<span class='no'>j</span>) }</div><div class='output co'>#&gt; [1] 1
#&gt; [1] 2
#&gt; [1] 3
#&gt; [1] 4
#&gt; [1] 5
#&gt; [1] 6
#&gt; [1] 7
#&gt; [1] 8
#&gt; [1] 9
#&gt; [1] 10</div><div class='input'> <span class='no'>binCount</span> <span class='kw'>&lt;-</span> <span class='fl'>10</span> + ( <span class='fu'><a href='https://rdrr.io/r/base/which.min.html'>which.min</a></span>( <span class='no'>aics</span> ) - <span class='fl'>1</span> ) * <span class='fl'>10</span>
 <span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>binCounts</span>, <span class='no'>aics</span>)</div><div class='img'><img src='coxph_mpl_dc-1.png' alt='' width='700' height='433' /></div><div class='input'>
 <span class='co'>##-- control inputs for the coxph_mpl_dc function</span>
 <span class='no'>control</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='coxph_mpl_dc.control.html'>coxph_mpl_dc.control</a></span>(<span class='kw'>ordSp</span> <span class='kw'>=</span> <span class='fl'>4</span>,
                             <span class='kw'>binCount</span> <span class='kw'>=</span> <span class='no'>binCount</span>, <span class='kw'>tie</span> <span class='kw'>=</span> <span class='st'>'No'</span>,
                             <span class='kw'>tau</span> <span class='kw'>=</span> <span class='fl'>0.8</span>, <span class='kw'>copula</span> <span class='kw'>=</span> <span class='no'>copula3</span>,
                             <span class='kw'>pent</span> <span class='kw'>=</span> <span class='st'>'penalty_mspl'</span>, <span class='kw'>smpart</span> <span class='kw'>=</span> <span class='st'>'REML'</span>,
                             <span class='kw'>penc</span> <span class='kw'>=</span> <span class='st'>'penalty_mspl'</span>, <span class='kw'>smparc</span> <span class='kw'>=</span> <span class='st'>'REML'</span>,
                             <span class='kw'>maxit2</span> <span class='kw'>=</span> <span class='fl'>100</span>, <span class='kw'>maxit</span> <span class='kw'>=</span> <span class='fl'>100000</span>,
                             <span class='kw'>mid</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>asy</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>ac</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>cv</span> <span class='kw'>=</span> <span class='fl'>1</span>,
                             <span class='kw'>ac.theta</span> <span class='kw'>=</span> <span class='fl'>1e-5</span>, <span class='kw'>ac.gamma</span> <span class='kw'>=</span> <span class='fl'>1e-5</span>,
                             <span class='kw'>ac.Utheta</span> <span class='kw'>=</span> -<span class='fl'>1e-2</span>, <span class='kw'>ac.Ugamma</span> <span class='kw'>=</span> -<span class='fl'>1e-2</span>,
                             <span class='kw'>min.theta</span> <span class='kw'>=</span> <span class='fl'>1e-7</span>, <span class='kw'>min.gamma</span> <span class='kw'>=</span> <span class='fl'>1e-7</span>, <span class='kw'>min.ht</span> <span class='kw'>=</span> <span class='fl'>1e-7</span>, <span class='kw'>min.hc</span> <span class='kw'>=</span> <span class='fl'>1e-7</span>,
                             <span class='kw'>min.St</span> <span class='kw'>=</span> <span class='fl'>1e-7</span>, <span class='kw'>min.Sc</span> <span class='kw'>=</span> <span class='fl'>1e-7</span>, <span class='kw'>min.C</span> <span class='kw'>=</span> <span class='fl'>1e-7</span>, <span class='kw'>min.dC</span> <span class='kw'>=</span> <span class='fl'>1e-7</span>,
                             <span class='kw'>eps</span> <span class='kw'>=</span> <span class='fl'>1e-5</span>, <span class='kw'>tol.thga</span> <span class='kw'>=</span> <span class='fl'>1e-5</span>, <span class='kw'>tol.bph</span> <span class='kw'>=</span> <span class='fl'>1e-5</span>, <span class='kw'>tol.smpar</span> <span class='kw'>=</span> <span class='fl'>1e-2</span>,
                             <span class='kw'>cat.smpar</span> <span class='kw'>=</span> <span class='st'>'No'</span> )

 <span class='co'>##-- Fitting cox ph hazard model for T using MPL and an correct copula</span>
 <span class='co'>#with REML smoothing parameters</span>
 <span class='no'>coxMPLests5</span> <span class='kw'>&lt;-</span> <span class='fu'>coxph_mpl_dc</span>(<span class='no'>surv</span>, <span class='no'>cova</span>, <span class='no'>control</span>, )
 <span class='no'>mpl_beta_phi_zp5</span> <span class='kw'>&lt;-</span> <span class='no'>coxMPLests5</span>$<span class='no'>mpl_beta_phi_zp</span>
 <span class='no'>mpl_h0t5</span> <span class='kw'>&lt;-</span> <span class='no'>coxMPLests5</span>$<span class='no'>mpl_h0t</span>
 <span class='no'>mpl_h0Ti5</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/approxfun.html'>approx</a></span>( <span class='no'>X</span>, <span class='no'>mpl_h0t5</span>, <span class='kw'>xout</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>, <span class='fl'>5.4</span>, <span class='fl'>0.01</span>),
                    <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"constant"</span>, <span class='kw'>rule</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>ties</span> <span class='kw'>=</span> <span class='no'>mean</span>)$<span class='no'>y</span>

 <span class='co'>##-- Real marginal baseline hazard for T</span>
 <span class='no'>ht0b</span> <span class='kw'>&lt;-</span> <span class='no'>a</span> * (<span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>, <span class='fl'>5.4</span>, <span class='fl'>0.01</span>) ^ (<span class='no'>a</span> - <span class='fl'>1</span>)) / (<span class='no'>lambda</span> ^ <span class='no'>a</span>)

 <span class='co'>##-- Selectiong a smoothing parameter for T using CV method</span>
 <span class='co'>#given zero for the smoothing parameter of C</span>
 <span class='no'>smparts</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>10</span>, <span class='fl'>100</span>, <span class='fl'>10</span>)
 <span class='no'>smn</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>smparts</span>)
 <span class='no'>smparcs</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>0</span>, <span class='no'>smn</span>)
 <span class='no'>cvls</span><span class='kw'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>0</span>, <span class='no'>smn</span>)
 <span class='kw'>for</span> (<span class='no'>j</span> <span class='kw'>in</span> <span class='fl'>1</span>:<span class='no'>smn</span>){
 <span class='no'>control</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='coxph_mpl_dc.control.html'>coxph_mpl_dc.control</a></span>(<span class='kw'>ordSp</span> <span class='kw'>=</span> <span class='fl'>4</span>,
                                <span class='kw'>binCount</span> <span class='kw'>=</span> <span class='no'>binCount</span>, <span class='kw'>tie</span> <span class='kw'>=</span> <span class='st'>'No'</span>,
                                <span class='kw'>tau</span> <span class='kw'>=</span> <span class='fl'>0.8</span>, <span class='kw'>copula</span> <span class='kw'>=</span> <span class='no'>copula3</span>,
                                <span class='kw'>pent</span> <span class='kw'>=</span> <span class='st'>'penalty_mspl'</span>, <span class='kw'>smpart</span> <span class='kw'>=</span> <span class='no'>smparts</span>[<span class='no'>j</span>],
                                <span class='kw'>penc</span> <span class='kw'>=</span> <span class='st'>'penalty_mspl'</span>, <span class='kw'>smparc</span> <span class='kw'>=</span> <span class='no'>smparcs</span>[<span class='no'>j</span>],
                                <span class='kw'>maxit2</span> <span class='kw'>=</span> <span class='fl'>100</span>, <span class='kw'>maxit</span> <span class='kw'>=</span> <span class='fl'>10000</span>,
                                <span class='kw'>mid</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>asy</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>ac</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>cv</span> <span class='kw'>=</span> <span class='fl'>1</span>,
                                <span class='kw'>ac.theta</span><span class='kw'>=</span><span class='fl'>1e-5</span>, <span class='kw'>ac.gamma</span><span class='kw'>=</span><span class='fl'>1e-5</span>, <span class='kw'>ac.Utheta</span><span class='kw'>=</span>-<span class='fl'>1e-2</span>,
                                <span class='kw'>ac.Ugamma</span><span class='kw'>=</span>-<span class='fl'>1e-2</span>,
                                <span class='kw'>min.theta</span><span class='kw'>=</span><span class='fl'>1e-7</span>, <span class='kw'>min.gamma</span><span class='kw'>=</span><span class='fl'>1e-7</span>,
                                <span class='kw'>min.ht</span><span class='kw'>=</span><span class='fl'>1e-7</span>, <span class='kw'>min.hc</span><span class='kw'>=</span><span class='fl'>1e-7</span>,
                                <span class='kw'>min.St</span><span class='kw'>=</span><span class='fl'>1e-7</span>, <span class='kw'>min.Sc</span><span class='kw'>=</span><span class='fl'>1e-7</span>, <span class='kw'>min.C</span><span class='kw'>=</span><span class='fl'>1e-7</span>, <span class='kw'>min.dC</span><span class='kw'>=</span><span class='fl'>1e-7</span>,
                                <span class='kw'>eps</span><span class='kw'>=</span><span class='fl'>1e-5</span>, <span class='kw'>tol.thga</span><span class='kw'>=</span><span class='fl'>1e-5</span>, <span class='kw'>tol.bph</span><span class='kw'>=</span><span class='fl'>1e-5</span>, <span class='kw'>tol.smpar</span><span class='kw'>=</span><span class='fl'>1e-2</span>,
                                <span class='kw'>cat.smpar</span> <span class='kw'>=</span> <span class='st'>'No'</span>)
 <span class='no'>cvls</span>[<span class='no'>j</span>]<span class='kw'>&lt;-</span><span class='fu'>coxph_mpl_dc</span>(<span class='no'>surv</span>, <span class='no'>cova</span>, <span class='no'>control</span>)$<span class='no'>mpl_cvl</span>
 <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span>(<span class='no'>j</span>) }</div><div class='output co'>#&gt; [1] 1
#&gt; [1] 2
#&gt; [1] 3
#&gt; [1] 4
#&gt; [1] 5
#&gt; [1] 6
#&gt; [1] 7
#&gt; [1] 8
#&gt; [1] 9
#&gt; [1] 10</div><div class='input'> <span class='no'>smpart</span> <span class='kw'>&lt;-</span> <span class='fl'>10</span> + ( <span class='fu'><a href='https://rdrr.io/r/base/which.min.html'>which.max</a></span>( <span class='no'>cvls</span> ) - <span class='fl'>1</span> ) * <span class='fl'>10</span>
 <span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>smparts</span>, <span class='no'>cvls</span>)</div><div class='img'><img src='coxph_mpl_dc-2.png' alt='' width='700' height='433' /></div><div class='input'>
 <span class='co'>##-- Fitting cox ph hazard model for T using MPL and an correct copula</span>
 <span class='co'>#with a cv smoothing parameter of T</span>
 <span class='no'>coxMPLests4</span> <span class='kw'>&lt;-</span> <span class='fu'>coxph_mpl_dc</span>(<span class='no'>surv</span>, <span class='no'>cova</span>,
                          <span class='kw'>ordSp</span><span class='kw'>=</span><span class='fl'>4</span>, <span class='kw'>binCount</span><span class='kw'>=</span><span class='no'>binCount</span>, <span class='kw'>tie</span><span class='kw'>=</span><span class='st'>'No'</span>,
                          <span class='kw'>tau</span><span class='kw'>=</span><span class='fl'>0.8</span>, <span class='kw'>copula</span><span class='kw'>=</span><span class='no'>copula3</span>,
                          <span class='kw'>pent</span><span class='kw'>=</span><span class='st'>'penalty_mspl'</span>, <span class='kw'>smpart</span><span class='kw'>=</span><span class='no'>smpart</span>, <span class='kw'>penc</span><span class='kw'>=</span><span class='st'>'penalty_mspl'</span>, <span class='kw'>smparc</span><span class='kw'>=</span><span class='fl'>0</span>,
                          <span class='kw'>maxit2</span><span class='kw'>=</span><span class='fl'>100</span>, <span class='kw'>maxit</span><span class='kw'>=</span><span class='fl'>100000</span>, <span class='kw'>mid</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>asy</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>ac</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>cv</span><span class='kw'>=</span><span class='fl'>1</span>,
                          <span class='kw'>ac.theta</span><span class='kw'>=</span><span class='fl'>1e-5</span>, <span class='kw'>ac.gamma</span><span class='kw'>=</span><span class='fl'>1e-5</span>, <span class='kw'>ac.Utheta</span><span class='kw'>=</span>-<span class='fl'>1e-2</span>, <span class='kw'>ac.Ugamma</span><span class='kw'>=</span>-<span class='fl'>1e-2</span>,
                          <span class='kw'>min.theta</span><span class='kw'>=</span><span class='fl'>1e-7</span>, <span class='kw'>min.gamma</span><span class='kw'>=</span><span class='fl'>1e-7</span>, <span class='kw'>min.ht</span><span class='kw'>=</span><span class='fl'>1e-7</span>, <span class='kw'>min.hc</span><span class='kw'>=</span><span class='fl'>1e-7</span>,
                          <span class='kw'>min.St</span><span class='kw'>=</span><span class='fl'>1e-7</span>, <span class='kw'>min.Sc</span><span class='kw'>=</span><span class='fl'>1e-7</span>,
                          <span class='kw'>min.C</span><span class='kw'>=</span><span class='fl'>1e-7</span>, <span class='kw'>min.dC</span><span class='kw'>=</span><span class='fl'>1e-7</span>, <span class='kw'>eps</span><span class='kw'>=</span><span class='fl'>1e-5</span>,
                          <span class='kw'>tol.thga</span><span class='kw'>=</span><span class='fl'>1e-5</span>, <span class='kw'>tol.bph</span><span class='kw'>=</span><span class='fl'>1e-5</span>, <span class='kw'>tol.smpar</span><span class='kw'>=</span><span class='fl'>1e-2</span>,
                          <span class='kw'>cat.smpar</span> <span class='kw'>=</span> <span class='st'>'No'</span>)
 <span class='no'>mpl_beta_phi_zp4</span> <span class='kw'>&lt;-</span> <span class='no'>coxMPLests4</span>$<span class='no'>mpl_beta_phi_zp</span>
 <span class='no'>mpl_h0t4</span> <span class='kw'>&lt;-</span> <span class='no'>coxMPLests4</span>$<span class='no'>mpl_h0t</span>
 <span class='no'>mpl_h0Ti4</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/approxfun.html'>approx</a></span>( <span class='no'>X</span>, <span class='no'>mpl_h0t4</span>, <span class='kw'>xout</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>, <span class='fl'>5.4</span>, <span class='fl'>0.01</span>),
                    <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"constant"</span>, <span class='kw'>rule</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>ties</span> <span class='kw'>=</span> <span class='no'>mean</span>)$<span class='no'>y</span>

 <span class='co'>##-- Fitting cox ph hazard model for T using MPL and an correct copula</span>
 <span class='co'>#with zero smoothing parameters</span>
 <span class='no'>coxMPLests3</span> <span class='kw'>&lt;-</span> <span class='fu'>coxph_mpl_dc</span>(<span class='no'>surv</span>, <span class='no'>cova</span>,
                          <span class='kw'>ordSp</span><span class='kw'>=</span><span class='fl'>4</span>, <span class='kw'>binCount</span><span class='kw'>=</span><span class='no'>binCount</span>, <span class='kw'>tie</span><span class='kw'>=</span><span class='st'>'No'</span>,
                          <span class='kw'>tau</span><span class='kw'>=</span><span class='fl'>0.8</span>, <span class='kw'>copula</span><span class='kw'>=</span><span class='no'>copula3</span>,
                          <span class='kw'>pent</span><span class='kw'>=</span><span class='st'>'penalty_mspl'</span>, <span class='kw'>smpart</span><span class='kw'>=</span><span class='fl'>0</span>, <span class='kw'>penc</span><span class='kw'>=</span><span class='st'>'penalty_mspl'</span>, <span class='kw'>smparc</span><span class='kw'>=</span><span class='fl'>0</span>,
                          <span class='kw'>maxit2</span><span class='kw'>=</span><span class='fl'>100</span>, <span class='kw'>maxit</span><span class='kw'>=</span><span class='fl'>100000</span>, <span class='kw'>mid</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>asy</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>ac</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>cv</span><span class='kw'>=</span><span class='fl'>1</span>,
                          <span class='kw'>ac.theta</span><span class='kw'>=</span><span class='fl'>1e-5</span>, <span class='kw'>ac.gamma</span><span class='kw'>=</span><span class='fl'>1e-5</span>, <span class='kw'>ac.Utheta</span><span class='kw'>=</span>-<span class='fl'>1e-2</span>, <span class='kw'>ac.Ugamma</span><span class='kw'>=</span>-<span class='fl'>1e-2</span>,
                          <span class='kw'>min.theta</span><span class='kw'>=</span><span class='fl'>1e-7</span>, <span class='kw'>min.gamma</span><span class='kw'>=</span><span class='fl'>1e-7</span>,
                          <span class='kw'>min.ht</span><span class='kw'>=</span><span class='fl'>1e-7</span>, <span class='kw'>min.hc</span><span class='kw'>=</span><span class='fl'>1e-7</span>, <span class='kw'>min.St</span><span class='kw'>=</span><span class='fl'>1e-7</span>, <span class='kw'>min.Sc</span><span class='kw'>=</span><span class='fl'>1e-7</span>,
                          <span class='kw'>min.C</span><span class='kw'>=</span><span class='fl'>1e-7</span>, <span class='kw'>min.dC</span><span class='kw'>=</span><span class='fl'>1e-7</span>, <span class='kw'>eps</span><span class='kw'>=</span><span class='fl'>1e-5</span>,
                          <span class='kw'>tol.thga</span><span class='kw'>=</span><span class='fl'>1e-5</span>, <span class='kw'>tol.bph</span><span class='kw'>=</span><span class='fl'>1e-5</span>, <span class='kw'>tol.smpar</span><span class='kw'>=</span><span class='fl'>1e-2</span>,
                          <span class='kw'>cat.smpar</span> <span class='kw'>=</span> <span class='st'>'No'</span>)
 <span class='no'>mpl_beta_phi_zp3</span> <span class='kw'>&lt;-</span> <span class='no'>coxMPLests3</span>$<span class='no'>mpl_beta_phi_zp</span>
 <span class='no'>mpl_h0t3</span> <span class='kw'>&lt;-</span> <span class='no'>coxMPLests3</span>$<span class='no'>mpl_h0t</span>
 <span class='no'>mpl_h0Ti3</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/approxfun.html'>approx</a></span>( <span class='no'>X</span>, <span class='no'>mpl_h0t3</span>, <span class='kw'>xout</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>, <span class='fl'>5.4</span>, <span class='fl'>0.01</span>),
 <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"constant"</span>, <span class='kw'>rule</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>ties</span> <span class='kw'>=</span> <span class='no'>mean</span>)$<span class='no'>y</span>

 <span class='co'>##-- Plot the true and estimated baseline hazards for T</span>
 <span class='no'>t_up</span> <span class='kw'>&lt;-</span> <span class='fl'>3.5</span>
 <span class='no'>y_uplim</span> <span class='kw'>&lt;-</span> <span class='fl'>2</span>
 <span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>, <span class='fl'>5.4</span>, <span class='fl'>0.01</span>)[<span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>, <span class='fl'>5.4</span>, <span class='fl'>0.01</span>)<span class='kw'>&lt;=</span><span class='no'>t_up</span>], <span class='no'>mpl_h0Ti5</span>[<span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>, <span class='fl'>5.4</span>, <span class='fl'>0.01</span>)<span class='kw'>&lt;=</span><span class='no'>t_up</span>],
      <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"l"</span>, <span class='kw'>col</span><span class='kw'>=</span><span class='st'>"grey"</span>, <span class='kw'>lty</span><span class='kw'>=</span><span class='fl'>4</span>, <span class='kw'>lwd</span><span class='kw'>=</span><span class='fl'>3</span>, <span class='kw'>cex.axis</span><span class='kw'>=</span><span class='fl'>1.6</span>, <span class='kw'>cex.lab</span><span class='kw'>=</span><span class='fl'>1.6</span>, <span class='kw'>ylim</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>, <span class='no'>y_uplim</span>),
      <span class='kw'>xlab</span><span class='kw'>=</span><span class='st'>'Time'</span>, <span class='kw'>ylab</span><span class='kw'>=</span><span class='st'>'Hazard'</span>)</div><div class='input'> <span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>, <span class='fl'>5.4</span>, <span class='fl'>0.01</span>)[<span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>, <span class='fl'>5.4</span>, <span class='fl'>0.01</span>)<span class='kw'>&lt;=</span><span class='no'>t_up</span>], <span class='no'>ht0b</span>[<span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>, <span class='fl'>5.4</span>, <span class='fl'>0.01</span>)<span class='kw'>&lt;=</span><span class='no'>t_up</span>],
      <span class='kw'>col</span><span class='kw'>=</span><span class='st'>"green"</span>,
      <span class='kw'>lty</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>lwd</span><span class='kw'>=</span><span class='fl'>3</span>, <span class='kw'>cex.axis</span><span class='kw'>=</span><span class='fl'>1.6</span>, <span class='kw'>cex.lab</span><span class='kw'>=</span><span class='fl'>1.6</span>, <span class='kw'>ylim</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>, <span class='no'>y_uplim</span>)
      )</div><div class='input'> <span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>, <span class='fl'>5.4</span>, <span class='fl'>0.01</span>)[<span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>, <span class='fl'>5.4</span>, <span class='fl'>0.01</span>)<span class='kw'>&lt;=</span><span class='no'>t_up</span>], <span class='no'>mpl_h0Ti4</span>[<span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>, <span class='fl'>5.4</span>, <span class='fl'>0.01</span>)<span class='kw'>&lt;=</span><span class='no'>t_up</span>],
      <span class='kw'>col</span><span class='kw'>=</span><span class='st'>"red"</span>,
      <span class='kw'>lty</span><span class='kw'>=</span><span class='fl'>4</span>, <span class='kw'>lwd</span><span class='kw'>=</span><span class='fl'>3</span>, <span class='kw'>cex.axis</span><span class='kw'>=</span><span class='fl'>1.6</span>, <span class='kw'>cex.lab</span><span class='kw'>=</span><span class='fl'>1.6</span>, <span class='kw'>ylim</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>, <span class='no'>y_uplim</span>)
      )</div><div class='input'> <span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>, <span class='fl'>5.4</span>, <span class='fl'>0.01</span>)[<span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>, <span class='fl'>5.4</span>, <span class='fl'>0.01</span>)<span class='kw'>&lt;=</span><span class='no'>t_up</span>], <span class='no'>mpl_h0Ti3</span>[<span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>, <span class='fl'>5.4</span>, <span class='fl'>0.01</span>)<span class='kw'>&lt;=</span><span class='no'>t_up</span>],
      <span class='kw'>col</span><span class='kw'>=</span><span class='st'>"blue"</span>,
      <span class='kw'>lty</span><span class='kw'>=</span><span class='fl'>4</span>, <span class='kw'>lwd</span><span class='kw'>=</span><span class='fl'>3</span>, <span class='kw'>cex.axis</span><span class='kw'>=</span><span class='fl'>1.6</span>, <span class='kw'>cex.lab</span><span class='kw'>=</span><span class='fl'>1.6</span>, <span class='kw'>ylim</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>, <span class='no'>y_uplim</span>)
      )</div><div class='img'><img src='coxph_mpl_dc-3.png' alt='' width='700' height='433' /></div><div class='input'>
# }



</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Jing Xu, Jun Ma, Thomas Fung.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


